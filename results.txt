Selected features for each outcome variable:
OS: ['age', 'biopsy_preTreat', 'tumor_size_cm_preTrt_preSurgery', 'nuclear_grade_preTrt', 'ERbb2_preTrt', 'Erbeta_preTrt', 'carboplatin', 'Race', 'RCB', 'menopausal_status']
DFS: ['chemotherapy', 'hormone_therapy', 'pCR_postTrt_days', 'topoihc_preTrt', 'metastasis_months', 'died_from_cancer_if_dead', 'ERBB2_CPN_amplified', 'tumor_size_cm_postTrt_1', 'pCR_spectrum', 'estrogen_receptor']
RFS: ['hormone_therapy', 'pCR_postTrt_days', 'metastasis_months', 'tumor_size_cm_postTrt', 'ESR1_preTrt', 'cytokeratin5_pos', 'epirubicin', 'tumor_stage_postTrt', 'pCR_spectrum', 'therapy']

Training for all decisions completed.
Feature importance for surgery:
[('preTrt_totalLymphNodes', 0.55), ('PR_percentage_preTrt', 0.45)]
Feature importance for chemotherapy:
[('postTrt_numPosLymphNodes', 0.5), ('topoihc_preTrt', 0.5)]
Feature importance for hormone_therapy:
[('pCR_postTrt_days', 0.56), ('metastasis_months', 0.44)]
Feature importance for radiotherapy:
[('metastasis_months_2', 0.24), ('preTrt_numPosLymphNodes', 0.23), ('PR_fmolmg_preTrt', 0.2), ('ER_fmolmg_preTrt', 0.19), ('age', 0.14)]
Building and evaluating Treatment Simulator model for OS.
Loaded trained Treatment Simulator model for OS
Fitting 5 folds for each of 144 candidates, totalling 720 fits

Best hyperparameters for OS:
{'C': 0.1, 'class_weight': 'balanced', 'degree': 2, 'gamma': 'scale', 'kernel': 'poly'}
Evaluating Treatment Simulator model for OS
Outcome: OS
Mean Accuracy: 0.4156
95% Confidence Interval: [0.3935, 0.4380]
Treatment Simulator evaluation completed for OS.
Building and evaluating Treatment Simulator model for DFS.
Loaded trained Treatment Simulator model for DFS

Best hyperparameters for DFS:
{'C': 0.1, 'class_weight': 'balanced', 'degree': 2, 'gamma': 'scale', 'kernel': 'poly'}
Evaluating Treatment Simulator model for DFS
Outcome: DFS
Mean Accuracy: 0.3654
95% Confidence Interval: [0.3445, 0.3870]
Treatment Simulator evaluation completed for DFS.

Best hyperparameters for RFS:
{'C': 0.1, 'class_weight': 'balanced', 'degree': 2, 'gamma': 'scale', 'kernel': 'poly'}
Evaluating Treatment Simulator model for RFS
Outcome: RFS
Mean Accuracy: 0.4118
95% Confidence Interval: [0.3885, 0.4330]
Treatment Simulator evaluation completed for RFS.


Evaluating DQL model for surgery
Evaluation metrics for surgery:
Accuracy: 0.6060
Precision: 0.6060
Recall: 0.6060
F1-score: 0.6060
Evaluating DQL model for chemotherapy
Evaluation metrics for chemotherapy:
Accuracy: 0.6040
Precision: 0.6040
Recall: 0.6040
F1-score: 0.6040
Evaluating DQL model for hormone_therapy
Evaluation metrics for hormone_therapy:
Accuracy: 0.6090
Precision: 0.6090
Recall: 0.6090
F1-score: 0.6090
Evaluating DQL model for radiotherapy
Evaluation metrics for radiotherapy:
Accuracy: 0.5990
Precision: 0.5990
Recall: 0.5990
F1-score: 0.5990
DQL model evaluation completed.

Treatment Simulator Evaluation Results:
Outcome: OS
Mean Accuracy: 0.4154
95% Confidence Interval: [0.3945, 0.4380]
Outcome: DFS
Mean Accuracy: 0.3659
95% Confidence Interval: [0.3455, 0.3875]
Outcome: RFS
Mean Accuracy: 0.4118
95% Confidence Interval: [0.3885, 0.4330]

DQL Model Evaluation Results:
Decision: surgery
Accuracy: 0.6060
Precision: 0.6060
Recall: 0.6060
F1-score: 0.6060
Decision: chemotherapy
Accuracy: 0.6040
Precision: 0.6040
Recall: 0.6040
F1-score: 0.6040
Decision: hormone_therapy
Accuracy: 0.6090
Precision: 0.6090
Recall: 0.6090
F1-score: 0.6090
Decision: radiotherapy
Accuracy: 0.5990
Precision: 0.5990
Recall: 0.5990
F1-score: 0.5990




with recursive training


Selected features for each outcome variable:
OS: ['age', 'biopsy_preTreat', 'tumor_size_cm_preTrt_preSurgery', 'nuclear_grade_preTrt', 'ERbb2_preTrt', 'Erbeta_preTrt', 'carboplatin', 'Race', 'RCB', 'menopausal_status']
DFS: ['chemotherapy', 'hormone_therapy', 'pCR_postTrt_days', 'topoihc_preTrt', 'metastasis_months', 'died_from_cancer_if_dead', 'ERBB2_CPN_amplified', 'tumor_size_cm_postTrt_1', 'pCR_spectrum', 'estrogen_receptor']
RFS: ['hormone_therapy', 'pCR_postTrt_days', 'metastasis_months', 'tumor_size_cm_postTrt', 'ESR1_preTrt', 'cytokeratin5_pos', 'epirubicin', 'tumor_stage_postTrt', 'pCR_spectrum', 'therapy']
Error: An unexpected error occurred during training: cannot access local variable 'prev_outputs' where it is not associated with a value
Feature importance for surgery:
[('preTrt_totalLymphNodes', 0.55), ('PR_percentage_preTrt', 0.45)]
Feature importance for chemotherapy:
[('postTrt_numPosLymphNodes', 0.5), ('topoihc_preTrt', 0.5)]
Feature importance for hormone_therapy:
[('pCR_postTrt_days', 0.56), ('metastasis_months', 0.44)]
Feature importance for radiotherapy:
[('metastasis_months_2', 0.24), ('preTrt_numPosLymphNodes', 0.23), ('PR_fmolmg_preTrt', 0.2), ('ER_fmolmg_preTrt', 0.19), ('age', 0.14)]
Building and evaluating Treatment Simulator model for OS.
Loaded trained Treatment Simulator model for OS
Best hyperparameters for OS:
{'C': 0.1, 'class_weight': 'balanced', 'degree': 2, 'gamma': 'scale', 'kernel': 'poly'}
Evaluating Treatment Simulator model for OS
Outcome: OS
Mean Accuracy: 0.4155
95% Confidence Interval: [0.3935, 0.4380]
Treatment Simulator evaluation completed for OS.
Building and evaluating Treatment Simulator model for DFS.
Loaded trained Treatment Simulator model for DFS

Best hyperparameters for DFS:
{'C': 0.1, 'class_weight': 'balanced', 'degree': 2, 'gamma': 'scale', 'kernel': 'poly'}
Evaluating Treatment Simulator model for DFS
Outcome: DFS
Mean Accuracy: 0.3658
95% Confidence Interval: [0.3455, 0.3880]
Treatment Simulator evaluation completed for DFS.
Building and evaluating Treatment Simulator model for RFS.
Loaded trained Treatment Simulator model for RFS

Best hyperparameters for RFS:
{'C': 0.1, 'class_weight': 'balanced', 'degree': 2, 'gamma': 'scale', 'kernel': 'poly'}
Evaluating Treatment Simulator model for RFS
Outcome: RFS
Mean Accuracy: 0.4113
95% Confidence Interval: [0.3895, 0.4320]
Treatment Simulator evaluation completed for RFS.
Evaluating DQL model for surgery
Evaluation metrics for surgery:
Accuracy: 0.6060
Precision: 0.6060
Recall: 0.6060
F1-score: 0.6060
Evaluating DQL model for chemotherapy
Evaluation metrics for chemotherapy:
Accuracy: 0.5830
Precision: 0.5830
Recall: 0.5830
F1-score: 0.5830
Evaluating DQL model for hormone_therapy
Evaluation metrics for hormone_therapy:
Accuracy: 0.6090
Precision: 0.6090
Recall: 0.6090
F1-score: 0.6090
Evaluating DQL model for radiotherapy
Evaluation metrics for radiotherapy:
Accuracy: 0.5990
Precision: 0.5990
Recall: 0.5990
F1-score: 0.5990
DQL model evaluation completed.

Treatment Simulator Evaluation Results:
Outcome: OS
Mean Accuracy: 0.4155
95% Confidence Interval: [0.3935, 0.4380]
Outcome: DFS
Mean Accuracy: 0.3658
95% Confidence Interval: [0.3455, 0.3880]
Outcome: RFS
Mean Accuracy: 0.4113
95% Confidence Interval: [0.3895, 0.4320]

DQL Model Evaluation Results:
Decision: surgery
Accuracy: 0.6060
Precision: 0.6060
Recall: 0.6060
F1-score: 0.6060
Decision: chemotherapy
Accuracy: 0.5830
Precision: 0.5830
Recall: 0.5830
F1-score: 0.5830
Decision: hormone_therapy
Accuracy: 0.6090
Precision: 0.6090
Recall: 0.6090
F1-score: 0.6090
Decision: radiotherapy
Accuracy: 0.5990
Precision: 0.5990
Recall: 0.5990
F1-score: 0.5990



try code results:

Data preprocessing completed.
Feature selection completed.
Selected features for each outcome variable:
OS: ['tumor_size', 'lymph_nodes', 'hormone_receptor_status', 'grade', 'stage', 'Ki67_expression', 'oncotype_score', 'chemotherapy', 'hormone_therapy', 'radiotherapy']
DFS: ['tumor_size', 'lymph_nodes', 'grade', 'stage', 'Ki67_expression', 'oncotype_score', 'surgery', 'chemotherapy', 'hormone_therapy', 'radiotherapy']
RFS: ['age', 'lymph_nodes', 'hormone_receptor_status', 'grade', 'stage', 'histology', 'Ki67_expression', 'surgery', 'chemotherapy', 'radiotherapy']
Training for all decisions completed.
Feature importance for surgery:
[('Ki67_expression', 0.17559743630036564), ('oncotype_score', 0.166630621051698), ('tumor_size', 0.1562049575467875), ('age', 0.13536120869214902), ('lymph_nodes', 0.06964188167974227), ('stage', 0.04710217895162929), ('histology', 0.04244474393049605), ('grade', 0.036924210178074665), ('chemotherapy', 0.025912375366184487), ('radiotherapy', 0.023425881873088025), ('hormone_receptor_status', 0.023255004681960206), ('DFS', 0.02173897659864683), ('RFS', 0.02160849275448115), ('hormone_therapy', 0.019997150441677252), ('OS', 0.017437702504689095), ('her2_status', 0.016717177448330546)]
Feature importance for chemotherapy:
[('Ki67_expression', 0.17310151456840578), ('tumor_size', 0.1709716529103117), ('oncotype_score', 0.16882418965528445), ('age', 0.13004891144317385), ('lymph_nodes', 0.07719656338891269), ('stage', 0.050641932098892777), ('histology', 0.03796990067511703), ('grade', 0.03473631328810257), ('surgery', 0.024824837721954804), ('hormone_receptor_status', 0.022977681177525317), ('hormone_therapy', 0.02104243215858484), ('DFS', 0.019293371814757605), ('radiotherapy', 0.018382729330267186), ('RFS', 0.017486865072681206), ('OS', 0.01666456426741837), ('her2_status', 0.015836540428609817)]
Feature importance for hormone_therapy:
[('tumor_size', 0.17209201782389877), ('oncotype_score', 0.1679554292737727), ('Ki67_expression', 0.16618284077645704), ('age', 0.13146761678215169), ('lymph_nodes', 0.07599634730002351), ('stage', 0.05361248408143049), ('histology', 0.03946930281481132), ('grade', 0.034893868904871866), ('chemotherapy', 0.023210030799928724), ('surgery', 0.022173917913322155), ('DFS', 0.021055380028805585), ('her2_status', 0.020970818268241192), ('hormone_receptor_status', 0.020648862021013306), ('radiotherapy', 0.01959625816424284), ('RFS', 0.01708303391154538), ('OS', 0.013591791135483467)]
Feature importance for radiotherapy:
[('oncotype_score', 0.1798719123122553), ('Ki67_expression', 0.17402137961004954), ('tumor_size', 0.1574601466243039), ('age', 0.13715068008803266), ('lymph_nodes', 0.08146354769415803), ('stage', 0.05017929132001145), ('histology', 0.03520488605730932), ('grade', 0.03514644834874418), ('surgery', 0.02320093442254187), ('hormone_receptor_status', 0.022089610020693994), ('chemotherapy', 0.019013115244216405), ('hormone_therapy', 0.01875410417113871), ('DFS', 0.01761745995228145), ('RFS', 0.01741775306567111), ('her2_status', 0.01683647201918131), ('OS', 0.014572259049410778)]
Building and evaluating Treatment Simulator model for OS.

